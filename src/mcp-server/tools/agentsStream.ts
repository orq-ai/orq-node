/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { agentsStream } from "../../funcs/agentsStream.js";
import * as operations from "../../models/operations/index.js";
import { formatResult, ToolDefinition } from "../tools.js";

const args = {
  requestBody: operations.StreamAgentRequestBody$inboundSchema,
  key: z.string(),
};

export const tool$agentsStream: ToolDefinition<typeof args> = {
  name: "agents-stream",
  description: `Stream agent execution in real-time

Executes an agent and streams the interaction in real-time using Server-Sent Events (SSE). Provides live updates as the agent processes the request, including message chunks, tool calls, and execution status. Perfect for building responsive chat interfaces and monitoring agent progress. The stream continues until the agent completes its task, encounters an error, or reaches the configured timeout (default 30 minutes, configurable 1-3600 seconds).`,
  args,
  tool: async (client, args, ctx) => {
    const [result, apiCall] = await agentsStream(
      client,
      args.requestBody,
      args.key,
      { fetchOptions: { signal: ctx.signal } },
    ).$inspect();

    if (!result.ok) {
      return {
        content: [{ type: "text", text: result.error.message }],
        isError: true,
      };
    }

    const value = result.value;

    return formatResult(value, apiCall);
  },
};
