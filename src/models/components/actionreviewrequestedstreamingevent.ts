/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { remap as remap$ } from "../../lib/primitives.js";
import { safeParse } from "../../lib/schemas.js";
import { Result as SafeParseResult } from "../../types/fp.js";
import { SDKValidationError } from "../errors/sdkvalidationerror.js";

export type Conditions = {
  /**
   * The argument of the tool call to evaluate
   */
  condition: string;
  /**
   * The operator to use
   */
  operator: string;
  /**
   * The value to compare against
   */
  value: string;
};

export type Tool = {
  /**
   * The id of the resource
   */
  id: string;
  /**
   * Optional tool key for custom tools
   */
  key?: string | undefined;
  actionType: string;
  displayName?: string | undefined;
  /**
   * Optional tool description
   */
  description?: string | undefined;
  requiresApproval: boolean;
  /**
   * Nested tool ID for MCP tools (identifies specific tool within MCP server)
   */
  toolId?: string | undefined;
  conditions?: Array<Conditions> | undefined;
  /**
   * Tool execution timeout in seconds (default: 2 minutes, max: 10 minutes)
   */
  timeout: number;
};

export type ActionReviewRequestedStreamingEventData = {
  agentId: string;
  actionId: string;
  requiresApproval: boolean;
  tool: Tool;
  input: { [k: string]: any };
  agentToolCallId: string;
  responseId?: string | undefined;
};

/**
 * Emitted when a tool action requires approval before execution. Contains the tool details, input arguments, and whether approval is mandatory.
 */
export type ActionReviewRequestedStreamingEvent = {
  type: "event.agents.action_review_requested";
  /**
   * ISO timestamp of the event
   */
  timestamp: string;
  data: ActionReviewRequestedStreamingEventData;
};

/** @internal */
export const Conditions$inboundSchema: z.ZodType<
  Conditions,
  z.ZodTypeDef,
  unknown
> = z.object({
  condition: z.string(),
  operator: z.string(),
  value: z.string(),
});

export function conditionsFromJSON(
  jsonString: string,
): SafeParseResult<Conditions, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => Conditions$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'Conditions' from JSON`,
  );
}

/** @internal */
export const Tool$inboundSchema: z.ZodType<Tool, z.ZodTypeDef, unknown> = z
  .object({
    id: z.string(),
    key: z.string().optional(),
    action_type: z.string(),
    display_name: z.string().optional(),
    description: z.string().optional(),
    requires_approval: z.boolean().default(false),
    tool_id: z.string().optional(),
    conditions: z.array(z.lazy(() => Conditions$inboundSchema)).optional(),
    timeout: z.number().default(120),
  }).transform((v) => {
    return remap$(v, {
      "action_type": "actionType",
      "display_name": "displayName",
      "requires_approval": "requiresApproval",
      "tool_id": "toolId",
    });
  });

export function toolFromJSON(
  jsonString: string,
): SafeParseResult<Tool, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => Tool$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'Tool' from JSON`,
  );
}

/** @internal */
export const ActionReviewRequestedStreamingEventData$inboundSchema: z.ZodType<
  ActionReviewRequestedStreamingEventData,
  z.ZodTypeDef,
  unknown
> = z.object({
  agent_id: z.string(),
  action_id: z.string(),
  requires_approval: z.boolean(),
  tool: z.lazy(() => Tool$inboundSchema),
  input: z.record(z.any()),
  agent_tool_call_id: z.string(),
  responseId: z.string().optional(),
}).transform((v) => {
  return remap$(v, {
    "agent_id": "agentId",
    "action_id": "actionId",
    "requires_approval": "requiresApproval",
    "agent_tool_call_id": "agentToolCallId",
  });
});

export function actionReviewRequestedStreamingEventDataFromJSON(
  jsonString: string,
): SafeParseResult<
  ActionReviewRequestedStreamingEventData,
  SDKValidationError
> {
  return safeParse(
    jsonString,
    (x) =>
      ActionReviewRequestedStreamingEventData$inboundSchema.parse(
        JSON.parse(x),
      ),
    `Failed to parse 'ActionReviewRequestedStreamingEventData' from JSON`,
  );
}

/** @internal */
export const ActionReviewRequestedStreamingEvent$inboundSchema: z.ZodType<
  ActionReviewRequestedStreamingEvent,
  z.ZodTypeDef,
  unknown
> = z.object({
  type: z.literal("event.agents.action_review_requested"),
  timestamp: z.string(),
  data: z.lazy(() => ActionReviewRequestedStreamingEventData$inboundSchema),
});

export function actionReviewRequestedStreamingEventFromJSON(
  jsonString: string,
): SafeParseResult<ActionReviewRequestedStreamingEvent, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) =>
      ActionReviewRequestedStreamingEvent$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ActionReviewRequestedStreamingEvent' from JSON`,
  );
}
