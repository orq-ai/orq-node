/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { remap as remap$ } from "../../lib/primitives.js";
import { safeParse } from "../../lib/schemas.js";
import { ClosedEnum } from "../../types/enums.js";
import { Result as SafeParseResult } from "../../types/fp.js";
import { SDKValidationError } from "../errors/sdkvalidationerror.js";

/**
 * The reason why the agent stopped generating
 */
export const ResponseDoneEventFinishReason = {
  Stop: "stop",
  Length: "length",
  ToolCalls: "tool_calls",
  ContentFilter: "content_filter",
  FunctionCall: "function_call",
  MaxIterations: "max_iterations",
  MaxTime: "max_time",
} as const;
/**
 * The reason why the agent stopped generating
 */
export type ResponseDoneEventFinishReason = ClosedEnum<
  typeof ResponseDoneEventFinishReason
>;

export type ResponseDoneEventPromptTokensDetails = {
  cachedTokens?: number | null | undefined;
  cacheCreationTokens?: number | null | undefined;
  /**
   * The number of audio input tokens consumed by the request.
   */
  audioTokens?: number | null | undefined;
};

export type ResponseDoneEventCompletionTokensDetails = {
  reasoningTokens?: number | null | undefined;
  acceptedPredictionTokens?: number | null | undefined;
  rejectedPredictionTokens?: number | null | undefined;
  /**
   * The number of audio output tokens produced by the response.
   */
  audioTokens?: number | null | undefined;
};

/**
 * Token usage statistics for the complete response
 */
export type ResponseDoneEventUsage = {
  /**
   * Number of tokens in the generated completion.
   */
  completionTokens?: number | undefined;
  /**
   * Number of tokens in the prompt.
   */
  promptTokens?: number | undefined;
  /**
   * Total number of tokens used in the request (prompt + completion).
   */
  totalTokens?: number | undefined;
  promptTokensDetails?: ResponseDoneEventPromptTokensDetails | null | undefined;
  completionTokensDetails?:
    | ResponseDoneEventCompletionTokensDetails
    | null
    | undefined;
};

export const ResponseDoneEventDataType = {
  Function: "function",
} as const;
export type ResponseDoneEventDataType = ClosedEnum<
  typeof ResponseDoneEventDataType
>;

export type ResponseDoneEventFunction = {
  /**
   * The name of the function to call
   */
  name?: string | undefined;
  /**
   * The arguments to pass to the function as JSON string
   */
  arguments?: string | undefined;
};

export type ResponseDoneEventPendingToolCalls = {
  /**
   * Unique identifier for the tool call
   */
  id: string;
  type: ResponseDoneEventDataType;
  function: ResponseDoneEventFunction;
};

export type ResponseDoneEventData = {
  /**
   * The reason why the agent stopped generating
   */
  finishReason: ResponseDoneEventFinishReason;
  /**
   * Token usage statistics for the complete response
   */
  usage?: ResponseDoneEventUsage | undefined;
  /**
   * Tool calls awaiting user response (when finishReason is function_call)
   */
  pendingToolCalls?: Array<ResponseDoneEventPendingToolCalls> | undefined;
};

/**
 * Emitted when the agent completes processing. Contains the finish reason and usage statistics.
 */
export type ResponseDoneEvent = {
  type: "response.done";
  /**
   * ISO timestamp of when the event occurred
   */
  timestamp: string;
  data: ResponseDoneEventData;
};

/** @internal */
export const ResponseDoneEventFinishReason$inboundSchema: z.ZodNativeEnum<
  typeof ResponseDoneEventFinishReason
> = z.nativeEnum(ResponseDoneEventFinishReason);
/** @internal */
export const ResponseDoneEventFinishReason$outboundSchema: z.ZodNativeEnum<
  typeof ResponseDoneEventFinishReason
> = ResponseDoneEventFinishReason$inboundSchema;

/** @internal */
export const ResponseDoneEventPromptTokensDetails$inboundSchema: z.ZodType<
  ResponseDoneEventPromptTokensDetails,
  z.ZodTypeDef,
  unknown
> = z.object({
  cached_tokens: z.nullable(z.number().int()).optional(),
  cache_creation_tokens: z.nullable(z.number().int()).optional(),
  audio_tokens: z.nullable(z.number().int()).optional(),
}).transform((v) => {
  return remap$(v, {
    "cached_tokens": "cachedTokens",
    "cache_creation_tokens": "cacheCreationTokens",
    "audio_tokens": "audioTokens",
  });
});
/** @internal */
export type ResponseDoneEventPromptTokensDetails$Outbound = {
  cached_tokens?: number | null | undefined;
  cache_creation_tokens?: number | null | undefined;
  audio_tokens?: number | null | undefined;
};

/** @internal */
export const ResponseDoneEventPromptTokensDetails$outboundSchema: z.ZodType<
  ResponseDoneEventPromptTokensDetails$Outbound,
  z.ZodTypeDef,
  ResponseDoneEventPromptTokensDetails
> = z.object({
  cachedTokens: z.nullable(z.number().int()).optional(),
  cacheCreationTokens: z.nullable(z.number().int()).optional(),
  audioTokens: z.nullable(z.number().int()).optional(),
}).transform((v) => {
  return remap$(v, {
    cachedTokens: "cached_tokens",
    cacheCreationTokens: "cache_creation_tokens",
    audioTokens: "audio_tokens",
  });
});

export function responseDoneEventPromptTokensDetailsToJSON(
  responseDoneEventPromptTokensDetails: ResponseDoneEventPromptTokensDetails,
): string {
  return JSON.stringify(
    ResponseDoneEventPromptTokensDetails$outboundSchema.parse(
      responseDoneEventPromptTokensDetails,
    ),
  );
}
export function responseDoneEventPromptTokensDetailsFromJSON(
  jsonString: string,
): SafeParseResult<ResponseDoneEventPromptTokensDetails, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) =>
      ResponseDoneEventPromptTokensDetails$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ResponseDoneEventPromptTokensDetails' from JSON`,
  );
}

/** @internal */
export const ResponseDoneEventCompletionTokensDetails$inboundSchema: z.ZodType<
  ResponseDoneEventCompletionTokensDetails,
  z.ZodTypeDef,
  unknown
> = z.object({
  reasoning_tokens: z.nullable(z.number()).optional(),
  accepted_prediction_tokens: z.nullable(z.number()).optional(),
  rejected_prediction_tokens: z.nullable(z.number()).optional(),
  audio_tokens: z.nullable(z.number().int()).optional(),
}).transform((v) => {
  return remap$(v, {
    "reasoning_tokens": "reasoningTokens",
    "accepted_prediction_tokens": "acceptedPredictionTokens",
    "rejected_prediction_tokens": "rejectedPredictionTokens",
    "audio_tokens": "audioTokens",
  });
});
/** @internal */
export type ResponseDoneEventCompletionTokensDetails$Outbound = {
  reasoning_tokens?: number | null | undefined;
  accepted_prediction_tokens?: number | null | undefined;
  rejected_prediction_tokens?: number | null | undefined;
  audio_tokens?: number | null | undefined;
};

/** @internal */
export const ResponseDoneEventCompletionTokensDetails$outboundSchema: z.ZodType<
  ResponseDoneEventCompletionTokensDetails$Outbound,
  z.ZodTypeDef,
  ResponseDoneEventCompletionTokensDetails
> = z.object({
  reasoningTokens: z.nullable(z.number()).optional(),
  acceptedPredictionTokens: z.nullable(z.number()).optional(),
  rejectedPredictionTokens: z.nullable(z.number()).optional(),
  audioTokens: z.nullable(z.number().int()).optional(),
}).transform((v) => {
  return remap$(v, {
    reasoningTokens: "reasoning_tokens",
    acceptedPredictionTokens: "accepted_prediction_tokens",
    rejectedPredictionTokens: "rejected_prediction_tokens",
    audioTokens: "audio_tokens",
  });
});

export function responseDoneEventCompletionTokensDetailsToJSON(
  responseDoneEventCompletionTokensDetails:
    ResponseDoneEventCompletionTokensDetails,
): string {
  return JSON.stringify(
    ResponseDoneEventCompletionTokensDetails$outboundSchema.parse(
      responseDoneEventCompletionTokensDetails,
    ),
  );
}
export function responseDoneEventCompletionTokensDetailsFromJSON(
  jsonString: string,
): SafeParseResult<
  ResponseDoneEventCompletionTokensDetails,
  SDKValidationError
> {
  return safeParse(
    jsonString,
    (x) =>
      ResponseDoneEventCompletionTokensDetails$inboundSchema.parse(
        JSON.parse(x),
      ),
    `Failed to parse 'ResponseDoneEventCompletionTokensDetails' from JSON`,
  );
}

/** @internal */
export const ResponseDoneEventUsage$inboundSchema: z.ZodType<
  ResponseDoneEventUsage,
  z.ZodTypeDef,
  unknown
> = z.object({
  completion_tokens: z.number().optional(),
  prompt_tokens: z.number().optional(),
  total_tokens: z.number().optional(),
  prompt_tokens_details: z.nullable(
    z.lazy(() => ResponseDoneEventPromptTokensDetails$inboundSchema),
  ).optional(),
  completion_tokens_details: z.nullable(
    z.lazy(() => ResponseDoneEventCompletionTokensDetails$inboundSchema),
  ).optional(),
}).transform((v) => {
  return remap$(v, {
    "completion_tokens": "completionTokens",
    "prompt_tokens": "promptTokens",
    "total_tokens": "totalTokens",
    "prompt_tokens_details": "promptTokensDetails",
    "completion_tokens_details": "completionTokensDetails",
  });
});
/** @internal */
export type ResponseDoneEventUsage$Outbound = {
  completion_tokens?: number | undefined;
  prompt_tokens?: number | undefined;
  total_tokens?: number | undefined;
  prompt_tokens_details?:
    | ResponseDoneEventPromptTokensDetails$Outbound
    | null
    | undefined;
  completion_tokens_details?:
    | ResponseDoneEventCompletionTokensDetails$Outbound
    | null
    | undefined;
};

/** @internal */
export const ResponseDoneEventUsage$outboundSchema: z.ZodType<
  ResponseDoneEventUsage$Outbound,
  z.ZodTypeDef,
  ResponseDoneEventUsage
> = z.object({
  completionTokens: z.number().optional(),
  promptTokens: z.number().optional(),
  totalTokens: z.number().optional(),
  promptTokensDetails: z.nullable(
    z.lazy(() => ResponseDoneEventPromptTokensDetails$outboundSchema),
  ).optional(),
  completionTokensDetails: z.nullable(
    z.lazy(() => ResponseDoneEventCompletionTokensDetails$outboundSchema),
  ).optional(),
}).transform((v) => {
  return remap$(v, {
    completionTokens: "completion_tokens",
    promptTokens: "prompt_tokens",
    totalTokens: "total_tokens",
    promptTokensDetails: "prompt_tokens_details",
    completionTokensDetails: "completion_tokens_details",
  });
});

export function responseDoneEventUsageToJSON(
  responseDoneEventUsage: ResponseDoneEventUsage,
): string {
  return JSON.stringify(
    ResponseDoneEventUsage$outboundSchema.parse(responseDoneEventUsage),
  );
}
export function responseDoneEventUsageFromJSON(
  jsonString: string,
): SafeParseResult<ResponseDoneEventUsage, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => ResponseDoneEventUsage$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ResponseDoneEventUsage' from JSON`,
  );
}

/** @internal */
export const ResponseDoneEventDataType$inboundSchema: z.ZodNativeEnum<
  typeof ResponseDoneEventDataType
> = z.nativeEnum(ResponseDoneEventDataType);
/** @internal */
export const ResponseDoneEventDataType$outboundSchema: z.ZodNativeEnum<
  typeof ResponseDoneEventDataType
> = ResponseDoneEventDataType$inboundSchema;

/** @internal */
export const ResponseDoneEventFunction$inboundSchema: z.ZodType<
  ResponseDoneEventFunction,
  z.ZodTypeDef,
  unknown
> = z.object({
  name: z.string().optional(),
  arguments: z.string().optional(),
});
/** @internal */
export type ResponseDoneEventFunction$Outbound = {
  name?: string | undefined;
  arguments?: string | undefined;
};

/** @internal */
export const ResponseDoneEventFunction$outboundSchema: z.ZodType<
  ResponseDoneEventFunction$Outbound,
  z.ZodTypeDef,
  ResponseDoneEventFunction
> = z.object({
  name: z.string().optional(),
  arguments: z.string().optional(),
});

export function responseDoneEventFunctionToJSON(
  responseDoneEventFunction: ResponseDoneEventFunction,
): string {
  return JSON.stringify(
    ResponseDoneEventFunction$outboundSchema.parse(responseDoneEventFunction),
  );
}
export function responseDoneEventFunctionFromJSON(
  jsonString: string,
): SafeParseResult<ResponseDoneEventFunction, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => ResponseDoneEventFunction$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ResponseDoneEventFunction' from JSON`,
  );
}

/** @internal */
export const ResponseDoneEventPendingToolCalls$inboundSchema: z.ZodType<
  ResponseDoneEventPendingToolCalls,
  z.ZodTypeDef,
  unknown
> = z.object({
  id: z.string(),
  type: ResponseDoneEventDataType$inboundSchema,
  function: z.lazy(() => ResponseDoneEventFunction$inboundSchema),
});
/** @internal */
export type ResponseDoneEventPendingToolCalls$Outbound = {
  id: string;
  type: string;
  function: ResponseDoneEventFunction$Outbound;
};

/** @internal */
export const ResponseDoneEventPendingToolCalls$outboundSchema: z.ZodType<
  ResponseDoneEventPendingToolCalls$Outbound,
  z.ZodTypeDef,
  ResponseDoneEventPendingToolCalls
> = z.object({
  id: z.string(),
  type: ResponseDoneEventDataType$outboundSchema,
  function: z.lazy(() => ResponseDoneEventFunction$outboundSchema),
});

export function responseDoneEventPendingToolCallsToJSON(
  responseDoneEventPendingToolCalls: ResponseDoneEventPendingToolCalls,
): string {
  return JSON.stringify(
    ResponseDoneEventPendingToolCalls$outboundSchema.parse(
      responseDoneEventPendingToolCalls,
    ),
  );
}
export function responseDoneEventPendingToolCallsFromJSON(
  jsonString: string,
): SafeParseResult<ResponseDoneEventPendingToolCalls, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => ResponseDoneEventPendingToolCalls$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ResponseDoneEventPendingToolCalls' from JSON`,
  );
}

/** @internal */
export const ResponseDoneEventData$inboundSchema: z.ZodType<
  ResponseDoneEventData,
  z.ZodTypeDef,
  unknown
> = z.object({
  finishReason: ResponseDoneEventFinishReason$inboundSchema,
  usage: z.lazy(() => ResponseDoneEventUsage$inboundSchema).optional(),
  pendingToolCalls: z.array(
    z.lazy(() => ResponseDoneEventPendingToolCalls$inboundSchema),
  ).optional(),
});
/** @internal */
export type ResponseDoneEventData$Outbound = {
  finishReason: string;
  usage?: ResponseDoneEventUsage$Outbound | undefined;
  pendingToolCalls?:
    | Array<ResponseDoneEventPendingToolCalls$Outbound>
    | undefined;
};

/** @internal */
export const ResponseDoneEventData$outboundSchema: z.ZodType<
  ResponseDoneEventData$Outbound,
  z.ZodTypeDef,
  ResponseDoneEventData
> = z.object({
  finishReason: ResponseDoneEventFinishReason$outboundSchema,
  usage: z.lazy(() => ResponseDoneEventUsage$outboundSchema).optional(),
  pendingToolCalls: z.array(
    z.lazy(() => ResponseDoneEventPendingToolCalls$outboundSchema),
  ).optional(),
});

export function responseDoneEventDataToJSON(
  responseDoneEventData: ResponseDoneEventData,
): string {
  return JSON.stringify(
    ResponseDoneEventData$outboundSchema.parse(responseDoneEventData),
  );
}
export function responseDoneEventDataFromJSON(
  jsonString: string,
): SafeParseResult<ResponseDoneEventData, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => ResponseDoneEventData$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ResponseDoneEventData' from JSON`,
  );
}

/** @internal */
export const ResponseDoneEvent$inboundSchema: z.ZodType<
  ResponseDoneEvent,
  z.ZodTypeDef,
  unknown
> = z.object({
  type: z.literal("response.done"),
  timestamp: z.string(),
  data: z.lazy(() => ResponseDoneEventData$inboundSchema),
});
/** @internal */
export type ResponseDoneEvent$Outbound = {
  type: "response.done";
  timestamp: string;
  data: ResponseDoneEventData$Outbound;
};

/** @internal */
export const ResponseDoneEvent$outboundSchema: z.ZodType<
  ResponseDoneEvent$Outbound,
  z.ZodTypeDef,
  ResponseDoneEvent
> = z.object({
  type: z.literal("response.done"),
  timestamp: z.string(),
  data: z.lazy(() => ResponseDoneEventData$outboundSchema),
});

export function responseDoneEventToJSON(
  responseDoneEvent: ResponseDoneEvent,
): string {
  return JSON.stringify(
    ResponseDoneEvent$outboundSchema.parse(responseDoneEvent),
  );
}
export function responseDoneEventFromJSON(
  jsonString: string,
): SafeParseResult<ResponseDoneEvent, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => ResponseDoneEvent$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ResponseDoneEvent' from JSON`,
  );
}
